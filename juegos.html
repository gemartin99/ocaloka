<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pruebas</title>
  <!-- Google Font & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet"> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.3/dist/css/splide.min.css">
  <style>
    :root {
      --bg-dark: #0f2027;
      --bg-mid: #203a43;
      --bg-light: #2c5364;
      --card-bg: rgba(0, 0, 0, 0.5);
      --accent: #feca57;
      --accent-hover: rgba(254, 202, 87, 0.8);
      --text-light: #ffffff;
      --text-dark: #1a1a1a;
      --radius: 16px;
      --shadow: 0 12px 24px rgba(0,0,0,0.6);
      --transition: 0.3s ease;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(120deg, var(--bg-dark), var(--bg-mid), var(--bg-light));
      color: var(--text-light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      width: 100%;
      max-width: 1200px;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(8px);
      margin-top: 1.5rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    header h1 {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent);
      letter-spacing: 1px;
    }
    header img {
      height: 60px;
      width: auto;
      margin-right: 1rem;
    }
    nav.menu {
      display: flex;
      gap: 1.5rem;
    }
    nav.menu a {
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--text-light);
      text-decoration: none;
      position: relative;
      padding: 0.3rem 0;
      transition: color var(--transition);
    }

    nav.menu a::after {
      content: '';
      position: absolute;
      bottom: -3px;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--accent);
      transition: width var(--transition);
    }
    nav.menu a:hover {
      color: var(--accent);
    }
    nav.menu a:hover::after {
      width: 100%;
    }
    .carrusel-container {
        position: relative;
        width: 95vw;
        max-width: 1400px;
        margin: 2rem auto;
        padding: 1rem;
        background: var(--card-bg);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        backdrop-filter: blur(12px);
        text-align: center;
        overflow: hidden;
    }
    .carrusel-container::before,
    .carrusel-container::after {
      content: '';
      position: absolute;
      border-radius: 50%;
      background: rgba(255,255,255,0.05);
      animation: float 8s ease-in-out infinite;
    }
    .carrusel-container::before {
      top: -40px;
      left: -40px;
      width: 180px;
      height: 180px;
    }
    .carrusel-container::after {
      bottom: -50px;
      right: -50px;
      width: 220px;
      height: 220px;
      animation-duration: 6s;
      animation-direction: reverse;
    }
    @keyframes float {
      0%,100% { transform: translate(0,0); }
      50% { transform: translate(20px, -20px); }
    }
    .carrusel-container h2 {
      font-size: 1.7rem;
      margin-bottom: 1.5rem;
      font-weight: 600;
      color: var(--accent);
    }
    .splide { margin-bottom: 1rem; }
    .splide__slide img {
        width: 35%;
        height: auto;
        max-width: none;
        transition: transform var(--transition);
    }
    .spin-button, .play-button {
      position: relative;
      display: inline-block;
      background: var(--accent);
      color: var(--text-dark);
      border: none;
      border-radius: 50px;
      padding: 0.8rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 6px 12px rgba(0,0,0,0.4);
      transition: background var(--transition), transform var(--transition);
      text-decoration: none;
      overflow: hidden;
    }
    .spin-button:hover, .play-button:hover {
      background: var(--accent-hover);
      transform: translateY(-3px);
    }
    .spin-button span, .play-button span { position: relative; z-index: 1; }
    #resultado {
      margin-top: 1.5rem;
      font-size: 1.4rem;
      font-weight: 500;
    }
    #playContainer { margin-top: 1rem; }
  </style>
</head>
<body>
  <header>
    <img src="assets/imgs/logo.png" alt="Logo">
    <h1>Oca Loka</h1>
    <nav class="menu">
      <a href="juegos.html"><span>Juegos</span></a>
      <a href="marcador.html"><span>Marcador</span></a>
      <a href="subastas.html"><span>Subastas</span></a>
    </nav>
  </header>

  <div class="carrusel-container">
    <h2>Pruebas</h2>
    <div id="splide" class="splide">
      <div class="splide__track">
        <ul class="splide__list">
          <li class="splide__slide"><img src="assets/imgs/sombreros.png" alt="Sombreros"></li>
          <li class="splide__slide"><img src="assets/imgs/duelo_cartas.png" alt="Duelo de cartas"></li>
          <li class="splide__slide"><img src="assets/imgs/adormir.png" alt="A dormir"></li>
          <li class="splide__slide"><img src="assets/imgs/banderin.png" alt="Banderin"></li>
          <li class="splide__slide"><img src="assets/imgs/soplacartas.png" alt="Sopla cartas"></li>
          <li class="splide__slide"><img src="assets/imgs/vaso.png" alt="Vaso"></li>
          <li class="splide__slide"><img src="assets/imgs/adivina.png" alt="Adivina"></li>
          <li class="splide__slide"><img src="assets/imgs/balon.png" alt="Bola loka"></li>
          <li class="splide__slide"><img src="assets/imgs/pescapatos.png" alt="Pesca patos"></li>
          <li class="splide__slide"><img src="assets/imgs/perreo.png" alt="Perreo"></li>
          <li class="splide__slide"><img src="assets/imgs/aro.png" alt="Pasa el aro"></li>
          <li class="splide__slide"><img src="assets/imgs/x2.png" alt="Puntos x2 en la siguiente prueba!"></li>
          <li class="splide__slide"><img src="assets/imgs/pictionary.png" alt="Pictionary"></li>
          <li class="splide__slide"><img src="assets/imgs/glovaso.png" alt="Glovaso"></li>
          <li class="splide__slide"><img src="assets/imgs/globos.png" alt="Globos"></li>
          <li class="splide__slide"><img src="assets/imgs/tiroarco.png" alt="Tiro al arco"></li>
          <li class="splide__slide"><img src="assets/imgs/tirolata.png" alt="Tiro a la lata"></li>
          <li class="splide__slide"><img src="assets/imgs/snorkel.png" alt="Snorkel a ciegas"></li>
          <li class="splide__slide"><img src="assets/imgs/tragabolas.png" alt="Tragabolas"></li>
          <li class="splide__slide"><img src="assets/imgs/basket.png" alt="Basket"></li>
        </ul>
      </div>
    </div>
    <button id="spinButton" class="spin-button"><span>Girar</span></button>
    <div id="resultado"></div>
    <div id="playContainer"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.3/dist/js/splide.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
  const splide = new Splide('#splide', {
    type: 'loop',
    perPage: 1,
    focus: 'center',
    pagination: false,
    arrows: false,
    speed: 600
  });
  splide.mount();
  const allTests = ['Sombreros', 'Duelo de cartas', 'A dormir', 'Banderin', 'Sopla cartas', 'Vaso', 'Adivina', 'Bola loka', 'Pesca patos', 'Perreo', 'Pasa el aro', 'Puntos x2 en la siguiente prueba!', 'Pictionary', 'Glovaso', 'Globos', 'Tiro al arco', 'Tiro a la lata', 'Snorkel a ciegas', 'Tragabolas', 'Basket'];
  let pruebas = JSON.parse(localStorage.getItem('pruebasEnCola')) || [];
  let usarCola = false;
  let siguientePrueba = null;

  if (pruebas.length > 0) {
    usarCola = true;
    siguientePrueba = pruebas[0];
  } else {
    pruebas = allTests.slice();
  }

  const spinBtn = document.getElementById('spinButton');
  let lastIndex = -1;

  spinBtn.addEventListener('click', function () {
  if (pruebas.length === 0) {
    alert('No quedan más pruebas en cola.');
    spinBtn.style.display = 'none';
    return;
  }

  if (usarCola) {
    let targetIndex = allTests.indexOf(siguientePrueba);
    if (targetIndex === -1) {
      alert('Error: la prueba en cola no está en la lista completa.');
      return;
    }
    let count = 0;
    const spins = 20 + Math.floor(Math.random() * 10);
    const interval = setInterval(() => {
      splide.go('>');
      count++;
      if (count > spins) {
        clearInterval(interval);
        const realIndex = splide.Components.Controller.toIndex(targetIndex);
        splide.go(realIndex);
        mostrarResultadoPorNombre(siguientePrueba);
        spinBtn.style.display = 'none';
      }
    }, 80);

  } else {
    let newIndex;
    do {
      newIndex = Math.floor(Math.random() * pruebas.length);
    } while (newIndex === lastIndex && pruebas.length > 1);
    lastIndex = newIndex;

    let count = 0, spins = 20 + Math.floor(Math.random() * 10);
    const interval = setInterval(() => {
      splide.go('>');
      if (++count > spins) {
        clearInterval(interval);
        const realIndex = splide.Components.Controller.toIndex(newIndex);
        splide.go(realIndex);
        mostrarResultado(newIndex);
        spinBtn.style.display = 'none';
      }
    }, 80);
  }
});

function mostrarResultadoPorNombre(nombrePrueba) {
  const resultadoDiv = document.getElementById('resultado');
  const ct = document.getElementById('playContainer');

  if (['Sombreros', 'Sopla cartas'].includes(nombrePrueba)) {
    ct.innerHTML = '<a href="vidas.html" class="play-button"><span>Jugar</span></a>';
  } else {
    ct.innerHTML = '<button class="spin-button" onclick="document.getElementById(\'spinButton\').click()"><span>Girar otra vez</span></button>';
  }

  if (usarCola) {
    pruebas.shift();
    localStorage.setItem('pruebasEnCola', JSON.stringify(pruebas));

    if (pruebas.length === 0) {
      usarCola = false;
      pruebas = allTests.slice();
    } else {
      siguientePrueba = pruebas[0];
    }
  }
}

});

  </script>
</body>
</html>
